<h2>Upload File</h2>

<input type="file" id="fileInput">
<select id="privacy">
    <option value="public">Public</option>
    <option value="private">Private</option>
</select>

<button onclick="uploadFile()">Upload</button>
<button onclick="logout()">Logout</button>

<script src="js/auth.js"></script>

<script>
const API = "http://localhost:5000/api"; // make sure this is defined
// getToken() should return token from localStorage
function getToken(){ return localStorage.getItem('token'); }

async function uploadFile() {
  const file = document.getElementById("fileInput").files[0];
  const privacy = document.getElementById("privacy").value;

  if (!file) return alert("Select a file");

  const formData = new FormData();
  formData.append("file", file);       // name must match multer .single('file')
  formData.append("privacy", privacy);

  const res = await fetch(API + "/upload", {
      method: "POST",
      headers: { "Authorization": "Bearer " + getToken() }, // OK to set auth
      body: formData
  });

  const out = await res.json();
  console.log("Upload response:", out);
  alert(out.message || out.error || JSON.stringify(out));
}
</script>
